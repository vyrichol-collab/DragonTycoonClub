<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DRAGON TYCOON CLUB // QUEST</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #000000;
            --text-main: #ffffff;
            --text-dim: #bbbbbb;
            --text-success: #00ff41;
            --text-error: #ff0055;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        html, body {
            background: var(--bg);
            height: 100%;
            overflow: hidden;
            background-color: #000;
        }

        body {
            color: var(--text-dim);
            font-family: 'Space Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
            display: flex;
            flex-direction: column;
        }

        #terminal-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px 20px 180px 20px;
            -webkit-overflow-scrolling: touch;
        }

        .line {
            margin-bottom: 4px;
            word-wrap: break-word;
            white-space: pre-wrap;
            display: block;
        }

        .prompt-line {
            color: var(--text-main);
            display: block;
            margin-top: 8px;
        }

        .active-input {
            display: inline;
            border-right: 8px solid var(--text-main);
            animation: blink 0.9s step-end infinite;
            padding-left: 4px;
            color: var(--text-main);
        }

        @keyframes blink {
            from, to { border-color: transparent; }
            50% { border-color: var(--text-main); }
        }

        .success { color: var(--text-success); }
        .error { color: var(--text-error); }
        .bright { color: var(--text-main); font-weight: 700; text-transform: uppercase; }

        .continue-btn {
            background: transparent;
            color: var(--text-main);
            border: 1px solid var(--text-main);
            padding: 12px 24px;
            font-family: 'Space Mono', monospace;
            cursor: pointer;
            margin-top: 25px;
            width: fit-content;
            display: block;
            text-transform: uppercase;
        }

        #hidden-field {
            position: absolute;
            width: 1px;
            height: 1px;
            opacity: 0;
            border: none;
            left: -999px;
        }
    </style>
</head>
<body>

    <div id="terminal-content"></div>
    <input type="text" id="hidden-field" autocomplete="off" spellcheck="false" inputmode="text">

    <script>
        const container = document.getElementById('terminal-content');
        const inputField = document.getElementById('hidden-field');
        const charSpeed = 20;
        let isWaitingForInput = false;

        function scrollToEnd() {
            container.scrollTop = container.scrollHeight;
        }

        async function print(text, type = 'default') {
            const el = document.createElement('div');
            el.className = 'line';
            if (type !== 'default') el.classList.add(type);
            container.appendChild(el);

            for (let i = 0; i <= text.length; i++) {
                el.textContent = text.substring(0, i);
                if (i % 3 === 0) scrollToEnd();
                await new Promise(r => setTimeout(r, charSpeed));
            }
            scrollToEnd();
            return el;
        }

        async function loading() {
            const el = document.createElement('div');
            el.className = 'line success';
            container.appendChild(el);
            for (let i = 0; i < 3; i++) {
                el.textContent = 'loading' + '.'.repeat(i + 1);
                scrollToEnd();
                await new Promise(r => setTimeout(r, 400));
            }
            container.removeChild(el);
        }

        function createPrompt() {
            const wrapper = document.createElement('div');
            wrapper.className = 'prompt-line';
            wrapper.innerHTML = `> enter command: <span id="cursor" class="active-input"></span>`;
            container.appendChild(wrapper);
            
            isWaitingForInput = true;
            inputField.value = "";
            inputField.focus();
            setTimeout(scrollToEnd, 50);
        }

        document.addEventListener('click', (e) => {
            if (isWaitingForInput && e.target.tagName !== 'BUTTON') {
                inputField.focus();
            }
        });

        inputField.addEventListener('input', () => {
            if (!isWaitingForInput) return;
            const cursor = document.getElementById('cursor');
            if (cursor) cursor.textContent = inputField.value.toLowerCase();
            scrollToEnd();
        });

        inputField.addEventListener('keydown', async (e) => {
            if (e.key === 'Enter' && isWaitingForInput) {
                const cmd = inputField.value.toLowerCase().trim();
                const cursor = document.getElementById('cursor');
                
                isWaitingForInput = false;
                if (cursor) {
                    cursor.id = "";
                    cursor.classList.remove('active-input');
                    cursor.style.borderRight = "none";
                }

                if (cmd === 'yes') {
                    await print('system: credentials verified', 'success');
                    await print('welcome to the circuit', 'bright');
                    await loading();
                    await print('alert: critical data corruption detected', 'error');
                    await print('source: encrypted_growth_sector.raw'); 
                    await print('restoration requires semantic key');
                    createPrompt();
                } 
                else if (cmd === 'absolute growth') {
                    await print('key accepted. reassembling data fragments', 'success');
                    await loading();
                    await print('status: GROWTH PROTOCOL ACTIVATED', 'success');
                    await print('welcome to the evolution', 'bright');
                    await print('system: final core access is restricted by a temporal marker');
                    await print('the gate will only open when three dragons descend upon the earth');
                    createPrompt();
                } 
                else if (cmd === '1104') {
                    await print('temporal marker detected. system sync complete', 'success');
                    await loading();
                    await print('establishing connection to the core');
                    await print('status: online', 'success');
                    // Убрали строку WELCOME DRAGON TYCOON CLUB
                    const btn = document.createElement('button');
                    btn.className = 'continue-btn';
                    btn.textContent = 'CONTINUE';
                    btn.onclick = () => window.location.href = 'gate.html';
                    container.appendChild(btn);
                    scrollToEnd();
                } 
                else {
                    if (cmd !== "") await print('error: access denied', 'error');
                    createPrompt();
                }
            }
        });

        async function init() {
            await print('did you fall into the "hole"?');
            await print('initializing system...', 'success');
            await print('establishing secure connection...', 'success');
            createPrompt();
        }

        window.onload = init;
    </script>
</body>
</html>
